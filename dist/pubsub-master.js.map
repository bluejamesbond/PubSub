{"version":3,"sources":["../src/pubsub-master.es6"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;IAIM;AACJ,WADI,YACJ,CAAY,EAAZ,EAA2B;QAAX,6DAAO,kBAAI;;0BADvB,cACuB;;AACzB,SAAK,IAAL,GAAY,IAAZ,CADyB;;AAGzB,SAAK,MAAL,GAAc,oBAAa,KAAK,KAAL,CAA3B,CAHyB;AAIzB,SAAK,GAAL,GAAW,oBAAY,EAAZ,EAAgB,IAAhB,CAAX,CAJyB;AAKzB,SAAK,KAAL,GAAa,KAAK,GAAL,CAAS,KAAT,CALY;GAA3B;;eADI;;2BASG,QAAQ,SAAS,YAAY,IAAI;;;AACtC,WAAK,MAAL,GAAc,MAAd,CADsC;;AAGtC,WAAK,MAAL,CAAY,MAAZ,CAAmB,MAAnB,EAHsC;;AAKtC,WAAK,GAAL,CAAS,EAAT,CAAY,WAAZ,EAAyB,UAAC,MAAD,EAAS,IAAT;eAAkB,MAAK,MAAL,CAAY,MAAZ,CAAmB,MAAnB,EAA2B,KAAK,KAAL;OAA7C,CAAzB,CALsC;AAMtC,WAAK,GAAL,CAAS,EAAT,CAAY,cAAZ,EAA4B,UAAC,MAAD,EAAS,IAAT;eAAkB,MAAK,MAAL,CAAY,MAAZ,CAAmB,MAAnB,EAA2B,KAAK,KAAL;OAA7C,CAA5B,CANsC;AAOtC,WAAK,GAAL,CAAS,EAAT,CAAY,WAAZ,EAAyB,UAAC,MAAD,EAAS,IAAT;eAAkB,MAAK,MAAL,CAAY,SAAZ,CAAsB,MAAtB,EAA8B,KAAK,OAAL,EAAc,KAAK,IAAL;OAA9D,CAAzB,CAPsC;AAQtC,WAAK,GAAL,CAAS,EAAT,CAAY,MAAZ,EACY,UAAC,MAAD,EAAS,IAAT;eAAkB,MAAK,MAAL,CAAY,IAAZ,CAAiB,MAAjB,EAAyB,KAAK,KAAL,EAAY,KAAK,OAAL,EAAc,KAAK,EAAL,EAAS,KAAK,IAAL,EAAW,KAAK,GAAL;OAAzF,CADZ,CARsC;AAUtC,WAAK,GAAL,CAAS,EAAT,CAAY,oBAAZ,EACY;eAAU,uBAAQ,MAAR,EAAgB,MAAK,IAAL,CAAU,MAAV,CAAhB,CAAkC,IAAlC,CAAuC;iBAAK,MAAK,GAAL,CAAS,IAAT,CAAc,MAAd,EAAsB,gBAAtB,EAAwC,CAAxC;SAAL;OAAjD,CADZ,CAVsC;;AAatC,WAAK,MAAL,CAAY,EAAZ,CAAe,iBAAf,EAAkC,UAAC,MAAD,EAAS,IAAT;eAAkB,MAAK,GAAL,CAAS,IAAT,CAAc,MAAd,EAAsB,iBAAtB,EAAyC,IAAzC;OAAlB,CAAlC,CAbsC;AActC,WAAK,MAAL,CAAY,EAAZ,CAAe,qBAAf,EAAsC,UAAC,MAAD,EAAS,IAAT;eAAkB,MAAK,GAAL,CAAS,IAAT,CAAc,MAAd,EAAsB,qBAAtB,EAA6C,IAA7C;OAAlB,CAAtC,CAdsC;AAetC,WAAK,MAAL,CAAY,EAAZ,CAAe,aAAf,EAA8B,UAAC,MAAD,EAAS,IAAT;eAAkB,MAAK,GAAL,CAAS,IAAT,CAAc,MAAd,EAAsB,aAAtB,EAAqC,IAArC;OAAlB,CAA9B,CAfsC;AAgBtC,WAAK,MAAL,CAAY,EAAZ,CAAe,eAAf,EAAgC,UAAC,MAAD,EAAS,IAAT;eAAkB,MAAK,GAAL,CAAS,IAAT,CAAc,MAAd,EAAsB,eAAtB,EAAuC,IAAvC;OAAlB,CAAhC,CAhBsC;;AAkBtC,WAAK,GAAL,CAAS,MAAT,CAAgB,OAAhB,EAAyB;eAAM,MAAK,MAAL,CAAY,MAAZ,CAAmB,UAAnB,EAA+B,EAA/B;OAAN,CAAzB,CAlBsC;;;;SATpC;;;kBA+BS","file":"pubsub-master.es6","sourcesContent":["import {SocketIO} from './client-com/index.es6';\nimport {NodeIPC} from './ipc/index.es6';\nimport address from './libs/address.es6';\n\nclass PubSubMaster {\n  constructor(id, opts = {}) {\n    this.opts = opts;\n\n    this.client = new SocketIO(opts.debug);\n    this.ipc = new NodeIPC(id, opts);\n    this.Slave = this.ipc.Slave;\n  }\n\n  listen(server, ipcPort, clientPort, cb) {\n    this.server = server;\n\n    this.client.attach(server);\n\n    this.ipc.on('add-token', (origin, data) => this.client.accept(origin, data.token));\n    this.ipc.on('remove-token', (origin, data) => this.client.reject(origin, data.token));\n    this.ipc.on('broadcast', (origin, data) => this.client.broadcast(origin, data.channel, data.data));\n    this.ipc.on('emit',\n                (origin, data) => this.client.emit(origin, data.token, data.channel, data.id, data.data, data.awk));\n    this.ipc.on('get-server-address',\n                origin => address(server, this.opts.remote).then(a => this.ipc.emit(origin, 'server-address', a)));\n\n    this.client.on('client-received', (origin, data) => this.ipc.emit(origin, 'client-received', data));\n    this.client.on('client-disconnected', (origin, data) => this.ipc.emit(origin, 'client-disconnected', data));\n    this.client.on('token-added', (origin, data) => this.ipc.emit(origin, 'token-added', data));\n    this.client.on('token-removed', (origin, data) => this.ipc.emit(origin, 'token-removed', data));\n\n    this.ipc.listen(ipcPort, () => this.server.listen(clientPort, cb));\n  }\n}\n\nexport default PubSubMaster;\n"]}